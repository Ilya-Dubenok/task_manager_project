input {

  beats {
    port => 5044
  }

}

filter {

  grok {
    match => [ "message", "%{TIMESTAMP_ISO8601:timestamp}\s{1,}%{LOGLEVEL:severity} %{GREEDYDATA:message}" ]
    overwrite => [ "message" ]
  }

  grok {
      match => ["message", "(?<stack>\tat.++)"]
      add_tag => ["stacktrace"]
      tag_on_failure => ["no_stack_trace"]
  }

  date {
    match => [ "timestamp" , "ISO8601" ]
  }

}


output {

  elasticsearch { 
    hosts => ["http://elasticsearch:9200"]
    index => "application"
  }

  stdout {
    codec => json
  }

}
